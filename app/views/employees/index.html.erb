<% if flash[:notice] %>
  <div class="flash flash-notice">
    <%= flash[:notice] %>
  </div>
<% end %>

<% if flash[:alert] %>
  <div class="flash flash-alert">
    <%= flash[:alert] %>
  </div>
  <% if flash[:errors] %>
    <ul class="error-list">
      <% flash[:errors].each do |error| %>
        <li><%= error %></li>
      <% end %>
    </ul>
  <% end %>
<% end %>

<div class="form-container">
  <h2>Upload Employee Data</h2>
  <%= form_with url: bulk_insert_employees_path, multipart: true, method: :post, local: true do |form| %>
    <div class="form-group">
      <label for="file">Upload Excel File:</label>
      <%= form.file_field :file, class: "form-control" %>
    </div>
    <div class="form-group">
      <%= form.submit "Upload", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

<div class="table-container">
  <h2>Employee List</h2>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Age</th>
      </tr>
    </thead>
    <tbody>
      <% @employees.each do |employee| %>
        <tr>
          <td><%= employee.name %></td>
          <td><%= employee.email %></td>
          <td><%= employee.age %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
